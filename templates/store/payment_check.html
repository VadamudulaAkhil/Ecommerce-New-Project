{% extends 'store/Main.html' %}
{% block content %}


<div class="contianer mx-auto p-6">
    <div class="max-w-lg mx-auto bg-white shadow-lg rounded-lg p-6">
        <h5>items : {{ order.get_cart }}</h5>
        <h5>Total : â‚¹{{ order.get_cart_total|floatformat:2 }}</h5>
        <a href="{% url 'Checkout' %}"><h5 style="float: right; margin-top: -40px; font-size: 20px;" class="btn btn-primary">Back</h5></a>
    <button id="rzp-button1" class="btn btn-success mt-4 bg-green-500 text-white px-6 py-2 rounded-lg">Pay Now</button>
    </div>
</div>

<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
<script>
    document.getElementById('rzp-button1').addEventListener('click' , async function() {
        let response = await fetch(`/create-payment/{{ order.id }}/`, {method:'POST'})
        let data = await response.json()


    var options = {
        "key": data.razorpay_key_id,
        "amount": "50000",
        "currency": "INR",
        "name": "Ecommerce",
        "description": "Test transaction",
        "handler": function (response){
            alert(response.razorpay_payment_id);
        },
        "prefill": {
            "name": "Test User",
            "email": "test@example.com",
            "contact": "9999999999"
        },
        "theme": {
            "color": "#528FF0"
        }
    };

    document.getElementById('rzp-button1').onclick = function(e){
        var rzp = new Razorpay(options);
        rzp.open();
        e.preventDefault();
    }
})
</script>




{% endblock content %}